#PRENOTAZIONE
##search fly 
##insert booking
##generate_ticket

#CANCELLAZIONE
##findbooking to cancellazione
##delete booking

search_flight_task:
  description: > 
    Analizza la richiesta dell'utente: "{query}".
    1. Recupera lo schema delle tabelle AEROPORTI e VOLI se necessario.
    2. Costruisci una query SQL per trovare il volo che corrisponde a:
       - Città di partenza e arrivo (fai JOIN con AEROPORTI per trovare i codici IATA se l'utente usa nomi città).
       - Data richiesta.
    3. Esegui la query.
    4. Restituisci TUTTI i dettagli del volo trovato (Id_Volo, OraPTZ, OraARR, Id_AptPTZ, Id_AptARR, DataPTZ, DataARR, Prezzo).
    Se ci sono più voli, seleziona il più pertinente o chiedi chiarimenti (ma per ora assumi il primo).
  expected_output: >
    Un report dettagliato contenente Id_Volo, Id_AptPTZ, Id_AptARR, DataPTZ, DataARR, OraPTZ, OraARR, Prezzo.
  agent: flight_analyst

insert_booking_task:
  description: >
    Usa i dettagli del volo trovati nel task precedente e i dati dell'utente (Nome, Cognome) dalla richiesta "{query}".
    1. Crea una query INSERT per la tabella PRENOTAZIONE.
    2. Assicurati di collegare correttamente l'Id_Volo.
    3. Verifica la sintassi con 'check_sql'.
    4. Esegui la INSERT.
    5. Recupera l'Id_prenotazioni della nuova prenotazione appena creata.
  expected_output: >
    Conferma di inserimento avvenuto con successo, incluso l'Id_prenotazioni generato.
  agent: booking_manager

generate_JSON_ticket_task:
  description: >
    Sei responsabile della creazione del biglietto finale.
    1. Raccogli i dati completi del volo (IATA, Città, Orari, Prezzo, Compagnia) dal report del search_flight_task.
    2. Raccogli i dati del passeggero (Nome, Cognome) e l'ID Prenotazione dall'insert_booking_task.
    3. Mappa rigorosamente tutti i campi nel formato JSON richiesto.
    4. Assicurati che i tipi di dato siano corretti (numeri come numeri, stringhe come stringhe).
  expected_output: >
    Un oggetto JSON valido e completo corrispondente allo schema TicketOutput.
  agent: customer_experience_agent

